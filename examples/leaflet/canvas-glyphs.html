<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GeoMorpher Leaflet Canvas Glyphs (D3)</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    html,body,#map { height: 100%; margin: 0; padding: 0; }
    .controls { position: absolute; left: 10px; top: 10px; z-index: 700; background: rgba(255,255,255,0.95); padding: 8px; border-radius: 6px; box-shadow: 0 2px 6px rgba(0,0,0,0.15); }
    .legend { list-style: none; padding: 0; margin: 0 0 6px 0; display:flex; gap:6px }
    .legend-item { display:flex; align-items:center; gap:6px }
    .legend-swatch { width:12px; height:12px; border-radius:2px; display:inline-block }
    .leaflet-canvas-glyphs { position:absolute; top:0; left:0; pointer-events:none; }
  </style>
    <script type="importmap">
    {
        "imports": {
            "npm:leaflet": "https://esm.sh/leaflet@1.9.4",
        "npm:d3": "https://esm.sh/d3@7.8.5?bundle",
            "@turf/turf": "https://esm.sh/@turf/turf@6.5.0?bundle",
            "@turf/helpers": "https://esm.sh/@turf/helpers@6.5.0?bundle",
            "flubber": "https://esm.sh/flubber@0.4.2?bundle",
            "lodash/cloneDeep.js": "https://esm.sh/lodash@4.17.21/cloneDeep?bundle",
            "lodash/keyBy.js": "https://esm.sh/lodash@4.17.21/keyBy?bundle",
            "lodash/mapValues.js": "https://esm.sh/lodash@4.17.21/mapValues?bundle",
            "lodash/isEmpty.js": "https://esm.sh/lodash@4.17.21/isEmpty?bundle"
        }
    }
    </script>
</head>
<body>
<div id="map"></div>
<div class="controls">
  <div style="margin-bottom:6px; font-weight:600">Canvas glyphs (D3)</div>
  <label>morph factor <span id="factorValue">0.00</span></label>
  <input id="morphFactor" type="range" min="0" max="1" step="0.01" value="0">
  <div style="margin-top:6px; display:flex; gap:8px; align-items:center">
    <ul id="glyphLegend" class="legend"></ul>
  </div>
</div>
<script type="module" src="./canvas-main.js"></script>
</body>
</html>
